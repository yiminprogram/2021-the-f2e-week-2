{"version":3,"sources":["assets/logo/logo-light.svg","components/Header.tsx","components/UserMark.tsx","components/BikeMark.tsx","components/ClusterMark.tsx","components/PopCard.tsx","utils/getBikeStation.ts","utils/getAuthorizationHeader.ts","components/Map.tsx","utils/getUserPosition.ts","utils/getQueryString.ts","App.tsx","style/global.tsx","style/theme.ts","index.tsx"],"names":["HeaderBar","styled","theme","palette","primary","main","Logo","Header","src","logoLight","alt","UserMark","width","height","viewBox","fill","xmlns","opacity","cx","cy","r","filter","stroke","strokeWidth","id","x","y","filterUnits","colorInterpolationFilters","floodOpacity","result","in","type","values","dx","dy","stdDeviation","in2","operator","mode","BikeMark","quantity","Box","sx","position","rx","ry","d","Typography","component","fontSize","color","left","top","transform","fontWeight","Circle","ClusterMark","count","Container","div","Title","h4","Item","Time","time","ItemText","span","PopCard","name","rentBike","returnBike","Stack","direction","spacing","alignItems","flexGrow","icon","faBicycle","faParking","faClock","getUrl","curLat","curLng","STATION_URL","INFO_URL","getAuthorizationHeader","GMTString","Date","toUTCString","HASH","HmacSHA1","process","HMAC","Base64","stringify","Authorization","UserIcon","L","divIcon","className","iconSize","iconAnchor","html","renderToString","Map","navigation","useNavigate","mapRef","useRef","bikeMarkRef","useEffect","map","zoomControl","tileLayer","attribution","addTo","setZoom","Promise","res","rej","navigator","geolocation","getCurrentPosition","then","setView","coords","latitude","longitude","marker","markers","markerClusterGroup","iconCreateFunction","cluster","getChildCount","axios","all","get","headers","spread","station","info","console","log","data","ele","StationName","Zh_tw","lat","StationPosition","PositionLat","lng","PositionLon","find","ele2","StationID","AvailableRentBikes","AvailableReturnBikes","UpdateTime","toLocaleTimeString","forEach","addLayer","popupAnchor","bindPopup","current","catch","timer","getMapCenter","setTimeout","obj","search","getCenter","on","clearTimeout","xs","lg","zIndex","Fab","faSearch","Page","App","global","css","light","dark","createTheme","warning","error","secondary","typography","fontFamily","h1","h2","h3","h5","body1","button","caption","components","MuiButton","styleOverrides","ReactDOM","render","StrictMode","ThemeProvider","styles","document","getElementById"],"mappings":"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","file":"static/js/main.99fc920a.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo-light.0c6a71ad.svg\";","import { styled } from '@mui/material';\nimport logoLight from '../assets/logo/logo-light.svg';\n\nconst HeaderBar = styled('header')`\n  height: 76px;\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: center;\n  align-items: center;\n  background-color: ${({ theme }) => theme.palette.primary.main};\n`;\n\nconst Logo = styled('div')`\n  > img {\n    height: 100%;\n    object-fit: contain;\n  }\n`;\n\nconst Header = () => {\n  return (\n    <HeaderBar>\n      <Logo>\n        <img src={logoLight} alt=\"logo\" />\n      </Logo>\n    </HeaderBar>\n  );\n};\n\nexport default Header;\n","const UserMark = () => {\n  return (\n    <svg\n      width=\"100%\"\n      height=\"100%\"\n      viewBox=\"0 0 80 80\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <circle opacity=\"0.2\" cx=\"37.5\" cy=\"37.5\" r=\"37.5\" fill=\"#DE994A\" />\n      <circle opacity=\"0.2\" cx=\"37.5\" cy=\"37.4999\" r=\"26.5\" fill=\"#DE994A\" />\n      <g filter=\"url(#filter0_d_38_276)\">\n        <circle cx=\"37.5\" cy=\"37.5\" r=\"13.5\" fill=\"#DE994A\" />\n        <circle cx=\"37.5\" cy=\"37.5\" r=\"16\" stroke=\"white\" strokeWidth=\"5\" />\n      </g>\n      <defs>\n        <filter\n          id=\"filter0_d_38_276\"\n          x=\"3\"\n          y=\"3.00003\"\n          width=\"77\"\n          height=\"77\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n            result=\"hardAlpha\"\n          />\n          <feOffset dx=\"4\" dy=\"4\" />\n          <feGaussianBlur stdDeviation=\"10\" />\n          <feComposite in2=\"hardAlpha\" operator=\"out\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0.4625 0 0 0 0 0.4625 0 0 0 0 0.4625 0 0 0 0.3 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow_38_276\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow_38_276\"\n            result=\"shape\"\n          />\n        </filter>\n      </defs>\n    </svg>\n  );\n};\n\nexport default UserMark;\n","import { Box, Typography } from '@mui/material';\n\ntype TProps = {\n  quantity: number;\n};\n\nconst BikeMark = ({ quantity }: TProps) => {\n  return (\n    <Box sx={{ position: 'relative' }}>\n      <svg\n        width=\"100%\"\n        height=\"100%\"\n        viewBox=\"0 0 58 77\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <ellipse\n          cx=\"29\"\n          cy=\"72.5\"\n          rx=\"15\"\n          ry=\"4.5\"\n          fill={quantity > 5 ? '#A4B375' : '#F27594'}\n        />\n        <path\n          d=\"M28.8003 0C12.9207 0 0.000293201 12.9204 0.000293201 28.782C-0.104107 51.984 27.7059 71.2224 28.8003 72C28.8003 72 57.7047 51.984 57.6003 28.8C57.6003 12.9204 44.6799 0 28.8003 0ZM28.8003 43.2C20.8443 43.2 14.4003 36.756 14.4003 28.8C14.4003 20.844 20.8443 14.4 28.8003 14.4C36.7563 14.4 43.2003 20.844 43.2003 28.8C43.2003 36.756 36.7563 43.2 28.8003 43.2Z\"\n          fill={quantity > 5 ? '#738047' : '#E75578'}\n        />\n        <circle cx=\"29\" cy=\"29\" r=\"19\" fill=\"white\" />\n      </svg>\n      <Typography\n        component=\"span\"\n        sx={{\n          fontSize: '1rem',\n          color: quantity > 5 ? '#738047' : '#E75578',\n          position: 'absolute',\n          left: '50%',\n          top: '18%',\n          transform: 'translateX(-50%)',\n          fontWeight: '700',\n        }}\n      >\n        {quantity}\n      </Typography>\n    </Box>\n  );\n};\n\nexport default BikeMark;\n","import { Box, styled } from '@mui/material';\n\nconst Circle = styled('span')`\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  justify-content: center;\n  align-items: center;\n  font-size: 1rem;\n  color: #fff;\n  background-color: #1e88e5;\n  font-weight: 700;\n  box-shadow: 0 0 0 3px #fff, 0 0 0 6px #1e88e5;\n`;\n\ntype TProps = {\n  count: number;\n};\n\nconst ClusterMark = ({ count }: TProps) => {\n  return (\n    <Box sx={{ position: 'relative', width: '100%', height: '100%' }}>\n      <Circle>{count}</Circle>\n    </Box>\n  );\n};\n\nexport default ClusterMark;\n","import { Stack } from '@mui/material';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faClock,\n  faBicycle,\n  faParking,\n} from '@fortawesome/free-solid-svg-icons';\nimport styled from '@emotion/styled';\n\ntype TStyle = {\n  quantity: number;\n};\n\nconst Container = styled.div`\n  width: 350px;\n  border-radius: 8px;\n  border: 2px solid #a4b375;\n  box-shadow: 0 0 20px rgba(118, 118, 118, 0.3);\n  background-color: #fff;\n  padding: 1rem 1.3rem;\n`;\n\nconst Title = styled.h4`\n  font-size: 1rem;\n  font-weight: 500;\n  color: #738047;\n  margin-bottom: 0.5rem;\n`;\n\nconst Item = styled.div<TStyle>`\n  flex-grow: 1;\n  background-color: ${({ quantity }) =>\n    quantity === 0 ? '#EEEEEE' : quantity > 10 ? '#DFE4CE' : '#F7D4DD'};\n  color: ${({ quantity }) =>\n    quantity === 0 ? '#767676' : quantity > 10 ? '#474F2C' : '#BC3253'};\n  border-radius: 4px;\n  padding: 0.5rem 0;\n  text-align: center;\n`;\n\nconst Time = styled.time`\n  flex-grow: 1;\n  color: #767676;\n  text-align: right;\n`;\n\nconst ItemText = styled.span`\n  font-size: 15px;\n  font-weight: 500;\n  font-family: 'Noto Sans TC';\n  padding-left: 0.3rem;\n`;\n\ntype TBikeData = {\n  name: string;\n  lat: number;\n  lng: number;\n  rentBike: number;\n  returnBike: number;\n  time: string;\n};\n\nconst PopCard = ({ time, name, rentBike, returnBike }: TBikeData) => {\n  return (\n    <Container>\n      <Title>{name}</Title>\n      <Stack direction=\"row\" spacing={1} alignItems=\"center\">\n        <Stack direction=\"row\" spacing={1} sx={{ flexGrow: 3 }}>\n          <Item quantity={rentBike}>\n            <FontAwesomeIcon icon={faBicycle} />\n            <ItemText>{rentBike}</ItemText>\n          </Item>\n          <Item quantity={returnBike}>\n            <FontAwesomeIcon icon={faParking} />\n            <ItemText>{returnBike}</ItemText>\n          </Item>\n        </Stack>\n        <Time>\n          <FontAwesomeIcon icon={faClock} />\n          <ItemText>{time}</ItemText>\n        </Time>\n      </Stack>\n    </Container>\n  );\n};\n\nexport default PopCard;\n","import axios from 'axios';\nimport { getAuthorizationHeader } from '../utils';\n\ntype TBikeData = {\n  name: string;\n  lat: number;\n  lng: number;\n  rentBike: number;\n  returnBike: number;\n  time: string;\n};\n\ntype TRemoteStation = {\n  StationID: string;\n  StationName: {\n    Zh_tw: string;\n    En: string;\n  };\n  UpdateTime: string;\n  StationPosition: {\n    PositionLon: number;\n    PositionLat: number;\n  };\n};\n\ntype TRmoteStateInfo = {\n  StationID: string;\n  AvailableRentBikes: number;\n  AvailableReturnBikes: number;\n};\n\nconst getUrl = (curLat: number, curLng: number) => {\n  return {\n    STATION_URL: `https://ptx.transportdata.tw/MOTC/v2/Bike/Station/NearBy?$spatialFilter=nearby(${curLat}%2C%20${curLng}%2C%201000)&$format=JSON`,\n    INFO_URL: `https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/NearBy?$spatialFilter=nearby(${curLat}%2C%20${curLng}%2C%201000)&$format=JSON`,\n  };\n};\n\nexport const getBikeStation = (\n  curLat: number,\n  curLng: number,\n): Promise<TBikeData[]> => {\n  return axios\n    .all([\n      axios.get(getUrl(curLat, curLng).STATION_URL, {\n        headers: getAuthorizationHeader(),\n      }),\n      axios.get(getUrl(curLat, curLng).INFO_URL, {\n        headers: getAuthorizationHeader(),\n      }),\n    ])\n    .then(\n      axios.spread((station, info) => {\n        console.log(station);\n        console.log(info);\n        return station.data.map((ele: TRemoteStation) => ({\n          name: ele.StationName.Zh_tw,\n          lat: ele.StationPosition.PositionLat,\n          lng: ele.StationPosition.PositionLon,\n          rentBike: info.data.find(\n            (ele2: TRmoteStateInfo) => ele2.StationID === ele.StationID,\n          ).AvailableRentBikes,\n          returnBike: info.data.find(\n            (ele2: TRmoteStateInfo) => ele2.StationID === ele.StationID,\n          ).AvailableReturnBikes,\n          time: new Date(ele.UpdateTime).toLocaleTimeString(),\n        }));\n      }),\n    );\n};\n","import { HmacSHA1 } from 'crypto-js';\nimport Base64 from 'crypto-js/enc-base64';\n\nexport const getAuthorizationHeader = () => {\n  const APP_ID = process.env.REACT_APP_APP_ID;\n  const APP_KEY = process.env.REACT_APP_APP_KEY!;\n\n  const GMTString = new Date().toUTCString();\n\n  const HASH = HmacSHA1(`x-date: ${GMTString}`, APP_KEY);\n\n  const HMAC = Base64.stringify(HASH);\n\n  const Authorization = `hmac username=\"${APP_ID}\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"${HMAC}\"`;\n\n  return { Authorization, 'X-Date': GMTString };\n};\n","import { useEffect, useRef } from 'react';\nimport { renderToString } from 'react-dom/server';\nimport { useNavigate } from 'react-router-dom';\nimport { Box, Fab } from '@mui/material';\nimport L from 'leaflet';\nimport 'leaflet.markercluster';\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport UserMark from '../components/UserMark';\nimport BikeMark from '../components/BikeMark';\nimport ClusterMark from './ClusterMark';\nimport PopCard from './PopCard';\nimport { getQueryString, getUserPosition, getBikeStation } from '../utils';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch } from '@fortawesome/free-solid-svg-icons';\n\n// map setting\nconst OSMUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';\n\nconst attribution =\n  '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors';\n\nconst UserIcon = L.divIcon({\n  className: 'user-mark',\n  iconSize: [80, 80],\n  iconAnchor: [40, 40],\n  html: renderToString(<UserMark />),\n});\n\nconst BikeIcon = (quantity: number) => {\n  return L.divIcon({\n    className: 'bike-icon',\n    iconSize: [48, 67],\n    iconAnchor: [19, 28.5],\n    popupAnchor: [-175, -135],\n    html: renderToString(<BikeMark quantity={quantity} />),\n  });\n};\n\nconst Map = () => {\n  // router\n  // const location = useLocation();\n  const navigation = useNavigate();\n\n  // search string\n  // const lat = Number(new URLSearchParams(location.search).get('lat'));\n  // const lng = Number(new URLSearchParams(location.search).get('lng'));\n\n  // map state\n  const mapRef = useRef<L.Map>();\n  const bikeMarkRef = useRef<L.MarkerClusterGroup>();\n\n  // map first render\n  useEffect(() => {\n    // leaflet create map (current position)\n    const map = L.map('map', { zoomControl: false });\n    L.tileLayer(OSMUrl, { attribution }).addTo(map);\n    map.setZoom(15);\n    getUserPosition()\n      .then((res) => {\n        map.setView([res.coords.latitude, res.coords.longitude], 15);\n        L.marker([res.coords.latitude, res.coords.longitude], {\n          icon: UserIcon,\n        }).addTo(map);\n        // Bike station marker\n        const markers = L.markerClusterGroup({\n          iconCreateFunction: (cluster) => {\n            return L.divIcon({\n              className: 'cluster-icon',\n              iconSize: [30, 30],\n              iconAnchor: [15, 15],\n              html: renderToString(\n                <ClusterMark count={cluster.getChildCount()} />,\n              ),\n            });\n          },\n        });\n        getBikeStation(res.coords.latitude, res.coords.longitude).then(\n          (res) => {\n            res.forEach((ele) => {\n              markers.addLayer(\n                L.marker([ele.lat, ele.lng], {\n                  icon: BikeIcon(ele.rentBike),\n                }).bindPopup(renderToString(<PopCard {...ele} />), {\n                  className: 'cus-popup',\n                }),\n              );\n            });\n          },\n        );\n        bikeMarkRef.current = markers;\n        map.addLayer(markers);\n      })\n      .catch(() => {\n        // console.log('no open gps');\n      });\n\n    // get map center position\n    const getMapCenter = () => {\n      return setTimeout(() => {\n        navigation({\n          search: getQueryString({\n            lat: map.getCenter().lat,\n            lng: map.getCenter().lng,\n          }),\n        });\n      }, 500);\n    };\n\n    // control map event\n    let timer: NodeJS.Timeout;\n    map.on('zoom', () => {\n      clearTimeout(timer);\n      timer = getMapCenter();\n    });\n    map.on('drag', () => {\n      clearTimeout(timer);\n      timer = getMapCenter();\n    });\n\n    mapRef.current = map;\n  }, []);\n\n  return (\n    <>\n      <Box\n        id=\"map\"\n        sx={{\n          position: 'relative',\n          width: {\n            xs: '100%',\n            lg: '120%',\n          },\n          height: '100%',\n          left: 0,\n          top: 0,\n          zIndex: 0,\n        }}\n      ></Box>\n      <Box>\n        <Fab>\n          <FontAwesomeIcon icon={faSearch} />\n          搜尋此區域\n        </Fab>\n      </Box>\n    </>\n  );\n};\n\nexport default Map;\n","export const getUserPosition = () => {\n  return new Promise<GeolocationPosition>((res, rej) => {\n    navigator.geolocation.getCurrentPosition(res, rej);\n  });\n};\n","import { stringify } from 'querystring';\n\nexport const getQueryString = (obj: any): string => {\n  return stringify(obj);\n};\n","import { styled } from '@mui/material';\nimport { Routes, Route } from 'react-router-dom';\nimport Header from './components/Header';\nimport SideBar from './views/Sidebar';\nimport ErrorPage from './views/ErrorPage';\nimport Station from './views/Station';\nimport Bike from './views/Bike';\nimport Attraction from './views/Attractions';\nimport Map from './components/Map';\n\nconst Page = styled('section')`\n  position: relative;\n  width: 100vw;\n  height: calc(100vh - 76px);\n  overflow: hidden;\n`;\n\nconst App = () => {\n  return (\n    <>\n      <Header />\n      <Page>\n        {/* <Routes>\n          <Route path=\"/\" element={<SideBar />}>\n            <Route path=\"/\" element={<Station />} />\n            <Route path=\"station\" element={<Station />} />\n            <Route path=\"bike\" element={<Bike />} />\n            <Route path=\"attraction\" element={<Attraction />} />\n          </Route>\n          <Route path=\"*\" element={<ErrorPage />} />\n        </Routes> */}\n        <Map />\n      </Page>\n    </>\n  );\n};\n\nexport default App;\n","import { css } from '@emotion/react';\n\nconst global = css`\n  html,\n  body,\n  div,\n  span,\n  applet,\n  object,\n  iframe,\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6,\n  p,\n  blockquote,\n  pre,\n  a,\n  abbr,\n  acronym,\n  address,\n  big,\n  cite,\n  code,\n  del,\n  dfn,\n  em,\n  img,\n  ins,\n  kbd,\n  q,\n  s,\n  samp,\n  small,\n  strike,\n  strong,\n  sub,\n  sup,\n  tt,\n  var,\n  b,\n  u,\n  i,\n  center,\n  dl,\n  dt,\n  dd,\n  ol,\n  ul,\n  li,\n  fieldset,\n  form,\n  label,\n  legend,\n  table,\n  caption,\n  tbody,\n  tfoot,\n  thead,\n  tr,\n  th,\n  td,\n  article,\n  aside,\n  canvas,\n  details,\n  embed,\n  figure,\n  figcaption,\n  footer,\n  header,\n  hgroup,\n  menu,\n  nav,\n  output,\n  ruby,\n  section,\n  summary,\n  time,\n  mark,\n  audio,\n  video {\n    margin: 0;\n    padding: 0;\n    border: 0;\n    font-size: 100%;\n    font: inherit;\n    vertical-align: baseline;\n  }\n  article,\n  aside,\n  details,\n  figcaption,\n  figure,\n  footer,\n  header,\n  hgroup,\n  menu,\n  nav,\n  section {\n    display: block;\n  }\n  body {\n    line-height: 1;\n  }\n  ol,\n  ul {\n    list-style: none;\n  }\n  blockquote,\n  q {\n    quotes: none;\n  }\n  blockquote:before,\n  blockquote:after,\n  q:before,\n  q:after {\n    content: '';\n    content: none;\n  }\n  table {\n    border-collapse: collapse;\n    border-spacing: 0;\n  }\n\n  html,\n  body {\n    font-family: 'Noto Sans TC';\n  }\n\n  *,\n  *::before,\n  *::after {\n    box-sizing: border-box;\n  }\n`;\n\nexport default global;\n","import { createTheme } from '@mui/material/styles';\n\nconst primary = {\n  main: '#738047',\n  light: '#DFE4CE',\n  dark: '#474F2C',\n};\n\nconst theme = createTheme({\n  palette: {\n    primary,\n    warning: {\n      main: '#DE994A',\n      light: '#FAF0E5',\n      dark: '#C67A24',\n    },\n    error: {\n      main: '#E75578',\n      light: '#F7D4DD',\n      dark: '#BC3253',\n    },\n    secondary: {\n      main: '#9A9A9A',\n      dark: '#767676',\n      light: '#EEEEEE',\n    },\n  },\n  typography: {\n    fontFamily: 'Noto Sans TC',\n    h1: {\n      color: primary.dark,\n      fontSize: '2.448rem',\n      fontWeight: '700',\n    },\n    h2: {\n      color: primary.dark,\n      fontSize: '2.074rem',\n      fontWeight: '700',\n    },\n    h3: {\n      color: primary.dark,\n      fontSize: '1.728rem',\n      fontWeight: '700',\n    },\n    h4: {\n      color: primary.dark,\n      fontSize: '1.44rem',\n      fontWeight: '700',\n    },\n    h5: {\n      color: primary.dark,\n      fontSize: '1.2rem',\n      fontWeight: '700',\n    },\n    body1: {\n      fontSize: '1.1rem',\n      fontWeight: '500',\n    },\n    button: {\n      fontSize: '0.833rem',\n    },\n    caption: {\n      fontSize: '0.694rem',\n      fontWeight: '400',\n    },\n  },\n  components: {\n    MuiButton: {\n      styleOverrides: {\n        // root: {\n        //   color: primary.main,\n        //   boxShadow: 'none',\n        // },\n        // contained: {\n        //   backgroundColor: '#ffffff',\n        //   border: '1px solid #A4B375',\n        //   borderRadius: '8px',\n        //   '&:hover': {\n        //     boxShadow: 'none',\n        //     backgroundColor: primary.light,\n        //   },\n        // },\n      },\n    },\n  },\n});\n\nexport default theme;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport { Global } from '@emotion/react';\nimport { ThemeProvider } from '@mui/material/styles';\nimport global from './style/global';\nimport theme from './style/theme';\nimport { HashRouter } from 'react-router-dom';\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <ThemeProvider theme={theme}>\n        <Global styles={global} />\n        <App />\n      </ThemeProvider>\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}